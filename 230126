<실무에 필요한 데이터베이스 개론 이해>

<aside>
💡 관계형 데이터베이스를 설계하는 방법은 주로 2가지가 있다.

#  E-R 모델과 릴레이션 변환 규칙을 이용한 설계
#  정규화를 이용한 설계 (이상 현상(ex. 삽입, 삭제, 수정시 발생하는 문제)을 제거하면서 중복을 최소화하고 더 좋은 ‘작은' 릴레이션으로 분해하는 작업이다.)

</aside>

## E-R모델과 릴레이션 변환 규칙을 이용한 설계

1. 요구사항 분석
2. 개념적 스키마 설계( →ERD)
3. 논리적 스키마 설계(→ 릴레이션 스키마의 테이블명세서)
4. 내부 스키마 설계(→DB스키마 생성 SQL문)

- 1. 요구사항 분석
    
    <aside>
    💡 데이터베이스에 대한 사용자의 요구사항을 수집하고 분석해서 아래와 같이 요구사항 명세서를 작성해야 합니다.
    
    </aside>
    
    ex)
    
    - 한빛 항공사에 회원으로 가입하려면 회원아이디, 비밀번호, 성명, 신용카드 정보를 입력해야 한다
    - 회원의 신용카드 정보는 여러 개를 저장할 수 있는데, 세부적으로는 신용카드번호, 유효기간을 저장할 수 있다
    - 한빛 항공사에서는 보유한 비행기에 대해 비행기번호, 출발날짜, 출발시간 정보를 저장하고 있다
    - 한빛 항공사에서는 좌석에 대한 좌석번호, 등급 정보를 저장하고 있다
    - 회원은 좌석을 예약하는데, 회원 한 명은 좌석을 하나만 예약할 수 있고, 한 좌석은 회원 한명만 예약할 수 있다
    - 비행기에는 좌석이 존재하는데, 비행기 하나에는 좌석이 여러 개 존재할 수 있고 한 좌석은 반드시 하나의 비행기에만 존재해야 한다.
        
        그리고 좌석은 비행기가 없으면 의미가 없다.
        
- 2.개념적 설계로 E-R다이어그램 만들기
    
    <aside>
    💡 작성한 요구사항 명세서에서 데이터베이스를 구성하는데 필요한 개체, 속성, 개체 간의 관계를 추출하여 ERD를 생성합니다.
    
    </aside>
    
    - 개체와 속성을 추출한다
        
        ⇒대부분 명사로 선별한다
        
    - 개체 간의 관계를 추출한다
        
        ⇒대부분 동사로 선별한다 (개체간의 관계를 나타내는 동사이여야 한다)
        
        ⇒관계에 속한 속성도 있을 수 있다
        
        ⇒1:1, 1:N, N:M
        
        ⇒필수적인 참여, 선택적인 참여
        
        - [ ]  **2.1** **개체(Entity)와 속성(attribute) 추출**
    
    <aside>
    💡 개념적 설계 단계에서 가장 먼저 해야 할 일은 개체를 추출하는 일입니다. 개체는 현실에서의 사물이나 사람이 생각하는 개념입니다. 개체를 나타내는 속성이 있고 여러 관련 속성이 모여 하나의 정보 단위를 이루는 것이 개체가 됩니다. 요구사항에서 개체는 대부분 명사로 이루어져 있지만, 속성과 구별할 필요가 있습니다. 항공사 명세서에서 개체와 속성을 구분해보겠습니다.
    
    </aside>
    
    ex)
    
    - 한빛 항공사에 회원으로 가입하려면 회원아이디, 비밀번호, 성명, 신용카드정보를 입력해야 한다.
    - 회원의 신용카드 정보는 여러 개를 저장할 수 있는데, 세부적으로는 신용카드번호, 유효기간을 저장하라 수 있다.
    - 한빛 항공사에서는 보유한 비행이게 대해 비행기번호, 출발날짜, 출발시간 정보를 저장하고 있다.
    - 한빛 항공사에서는 좌석에 대한 좌석번호, 등급 정보를 저장하고 있다.
    - 회언은 좌석을 예약하는데, 회원 한 명은 좌석을 하나만 예약할 수 있고, 한 좌석은 회원 한명만 예약할 수 있다.
    - 비행기에는 좌석이 존재하는데, 비행기 하나에는 좌석이 여러개 존재할 수 있고, 한 좌석은 반드시 하나의 비행기에만 존재해야 한다. 그리고 좌석은 비행기가 없으면 의미가 없다.
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/afee42bc-d151-4b23-b20d-5d4660b8be98/Untitled.png)
    
    <aside>
💡 개체와 속성이 구별되었다면 개체 간의 관계를 추출합니다. 개체 간의 관계도 여러 가지로 분류해서 정의됩니다.

- 일대일(1:1), 일대다(1:N), 다대다(N:M)
- 관계 : 선택적인 관계, 필수적인 관계
</aside>

#요구사항에서 개체 간의 관계는 동사로 묘사되기 때문에 동사부터 찾으면 됩니다. 빨간색으로 표시된 부분이 앞 써 추출한 개체 간의 관계를 나타냅니다.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/facecddc-2991-44ab-b4c9-04d3da0b8b89/Untitled.png)

#관계가 필수 인지 아니면 선택적인지 관계인지를 파악하는 게 개인적으로 쉽지 않아서 조금 더 정리를 해봤습니다.

- 필수적으로 관계에 참여 (전체 참여 : Total Participation)
- **[A : B]** 관계에서 개체 **집합 B의 모든 개체가 [A : B] 관계에 참여한다**개체 A에 대해 **개체 조건을 만족하는 개체가 반드시 존재할 경우에 필수적인 관계**라고 본다.
- 선택적으로 관계에 참여 (부분 참여 : Partial Participation)
- **[A : B]** 관계에서 개체 **집합 B의 일부 개체만 [A : B] 관계에 참여한다**객체 A에 대해 **개체 조건을 만족하는 개체가 존재할수도, 존재하지 않을 수도 있는 경우에 선태적인 관계**라고 본다.

**ex)**

- **예1. [학과 : 교수]**
    - 학과(필수): 한 학과에는 여러 교수가 소속된다
    - 교수(필수): 한 교수는 한 학과에만 소속된다
    
- **예2. [회원 : 주문]**
    - 회원(선택): 한 회원은 여러번 주문할 수 있다
    - 주문(필수): 한 주문은 한 회원에 의해 주문된다
    
- **예3. [교수 : 과목]**
    - 교수(선택): 한 교수는 여러 과목을 강의할 수 있다
    - 과목(필수): 한 과목은 한 교수에 의해서 강의되어야 한다

- **예4: [주문 : 주문목록]**
    - 주문(필수): 한 주문은 여러 개의 주문목록을 포함한다
    - 주문목록(필수): 한 주문목록에 하나의 주문내용에 포함된다
    
- **예5 : [고객 : 책] - 구매 관계**
    - 고개(필수): 모든 고객이 책을 반드시 구해야 한다
    - 책(선택) : 고객이 구매하지 않은 책이 존재할수 있다
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/cedea153-3e58-4932-bc19-3643bc291c99/Untitled.png)
    
    - [ ]  **2.3 분석한 내용으로 ERD 생성하기**
    
    <aside>
    💡 객체, 관계 정리만 잘 되면 쉽게 ERD를 만들어볼 수 있습니다. 추출한 내용을 가지고 릴레이션 스키마를 바로 생성할 수도 있지만, 다이어그램으로 다시 정리하면 큰 그림을 보면서 더 쉽게 전체 모델을 이해할 수 있는 장점이 있습니다.
    
    </aside>
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b5080ef3-575f-4eb7-b8d2-968d77165872/Untitled.png)
    
    ### ERD
    
    ---
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/090a277d-1fa3-42ae-9110-240899f747e6/Untitled.png)

- 3.논리적 설계로 릴레이션 스키마 및 테이블 명세서 만들기
    
    <aside>
    💡 ERD에서 릴레이션 스키마를 만들려면 다음 5가지 릴레이션 변환 규칙에 따라서 릴레이션 스키마로 변환해주면 됩니다.
    
    </aside>
    
    - 규칙1 : 모든 개체는 릴레이션으로 변환한다
    - 규칙2 : N:M 관계는 릴레이션으로 변환한다
    - **관계의 이름을 릴레이션 이름으로 하고 관계의 속성도 릴레이션의 속성으로 변환한다**
    - 규칙3 : 1:N 관계는 외래키로 표현한다
    - **규칙3-1: 일반적인 1:N 관계는 외래키로 표현한다**규칙3-2: 약한 개체가 참여하는 1:N 관계는 외래키로 포함해서 기본키로 지정한다
    - 규칙4 : 1:1 관계는 외래키로 표현한다
    - **규칙4-1: 일반적인 1:1 관계는 외래키를 서로 주고 받는다**규칙4-2: 1:1 관계에 필수적으로 참여하는 개체의 릴레이션만 외래키를 받는다규칙4-3: 모든 개체가 1:1 관계에 필수적으로 참여하면 릴레이션 하나로 합친다
    - 규칙5 : 다중 값 속성은 독립 릴레이션으로 변환한다
    
    
    ⇒ 하나하나 규칙에 따라 릴레이션을 생성해보자

- [ ]  **3.1 규칙1 : 모든 개체는 릴레이션으로 변환한다**
    
    <aside>
    💡 규칙1은 ER 다이어그램의 각 개체를 릴레이션으로 변환합니다. 개체는 하나의 테이블이 되고 속성은 테이블의 속성이 됩니다.
    
    </aside>
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b4e4a8c8-7e98-43af-acfe-a85c30bb2fa3/Untitled.png)
    
- [ ]  **3.2 규칙2 : N:M 관계는 릴레이션으로 변환한다**
    
    <aside>
    💡 공항사 ER 다이어그램에서는 N:M 관계가 없는 관계(초반에는 없었습니다 ;;)로 **회원 : 주문** 관계로 설명을 하도록 하겠습니다. 규칙2는 N:M 관계의 이름(ex. 주문)은 릴레이션의 이름이 되고 관계의 속성도 릴레이션의 속성으로 변환하면 됩니다.
    
    </aside>
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/714576cf-ca22-4f79-85bb-0043da791153/Untitled.png)
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2ac6f533-c8af-4c9e-8390-dd3b11abd164/Untitled.png)
    
    <aside>
    💡 N:M 관계는 주문 릴레이션을 생성하고 관계의 속성도 렐레이션에 포함시킵니다. 기본 키를 무엇으로 할지에 따라서 속성 구성이 조금씩 달라집니다.
    
    </aside>
    
    - 관계의 릴레이션에서 별도의 기본키 사용
        - 기본키 : 주문번호
        - 외래키 : 회원번호, 제품번호
    - 양쪽 객체의 기본키를 합쳐서 기본키로 사용
        - 기본키 : 회원번호 & 제품번호
        - 외래키 : 회원번호, 제품번호
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/36b454c1-5f3d-4c1f-b76e-b964e4eb7c10/Untitled.png)
